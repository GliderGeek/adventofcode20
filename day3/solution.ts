const count = (str: string) => {
    const re = /YOUR_PATTERN_HERE/g
    return ((str || '').match(re) || []).length
}

function makeMap(input: string[]): number[][]{
    let map = []
    for(let row=0; row<input.length; row++){
        let treeIndices = []
        for (let col = 0; col < input[row].length; col++) {
            if (input[row][col] == "#"){
                treeIndices.push(col)
            }            
        }
        map.push(treeIndices)
    }
    return map
}

// there is also collection.contains, but this needs specific ts compiltation settings
function includesNumber(collection: number[], item: number): boolean{
    for (let i = 0; i < collection.length; i++) {
        const element = collection[i];
        if (element == item){
            return true
        }
    }
    return false
}

function part1(map: number[][], columns: number, stepSizeRight: number, stepSizeDown: number): number{
    
    let row = 0
    let col = 0
    let colRelative = 0

    let trees = 0
    while (row < map.length){
        colRelative = col % columns
        if (includesNumber(map[row], colRelative)){
            trees++
        }

        col+=stepSizeRight
        row+=stepSizeDown
    }
    return trees
}

function part2(map: number[][], columns: number, directions: number[][]): number{

    let total = 1

    //TODO: figure out foreach
    for (let i = 0; i < directions.length; i++) {
        const direction = directions[i];
        
        let stepSizeRight = direction[0] 
        let stepSizeDown = direction[1] 
        trees = part1(map, columns, stepSizeRight, stepSizeDown)
        total *= trees
    }

    return total
}


var exampleInput: string[];
exampleInput = [
"..##.......",
"#...#...#..",
".#....#..#.",
"..#.#...#.#",
".#...##..#.",
"..#.##.....",
".#.#.#....#",
".#........#",
"#.##...#...",
"#...##....#",
".#..#...#.#",
]

var input: string[];
input = [
"..#..#......###.#...#......#..#",
"...#.....#...#...#..........#..",
"....#.#...............#.#.#....",
".........#.......##............",
"#.#....#.#####.##.#........#..#",
".....#...##.#..#.##...#.#..#...",
"#.#..###.#........#....##...#.#",
"..###.....#..###.....##........",
"#.#.#...........#.....#.#....##",
"...#.#.##.##.#.#......#...##.#.",
".....##.#..#....#..#...##...###",
"...#.....#..#..#...#.#....##...",
".#...##.#.........#...#.#......",
"....#...#.....#......#...#.....",
".#...#.....#....#......#...#...",
"#...#......####..##...###......",
"....#..#......##.##.....#..#...",
"....#....#.......#..#...#....#.",
"...##..#.##..#.#...#..##.......",
"##.#..#.....#.##.#....#..##....",
"#....#....#.....#..#.#.#.....#.",
"##...#.###.....#....#..#.#.#...",
"#..#.......#...#.#...#.#.....#.",
"....#.#.......#.....###..#..#.#",
"......####...#.#..#..#.#.#.#...",
"#...##.....#...#.#.........#.#.",
"......#...##.#..#.#........#...",
"..#.#...........#..##...###.##.",
"#......#.#......#.....#.....#.#",
".#...............###.#.###.....",
"...#...........##..#...##..##.#",
"#......#.##.#............#.##.#",
".#.#....#....###........#..#...",
"...##.#.#..#.##.#..##..#.##..##",
".....#...#.#.#...#....#......#.",
"..............#...##...........",
"..............##........#..###.",
".#.##.......#.....##.#......#..",
"..#......#..#.#####..#.#.......",
"#.#..#...#.#..#....#..#.##..#..",
"...##.......#.#............#...",
"...#....#..#.##.###.......#.###",
"..###..#....#..#.....##...#..#.",
"..#.###.##......###....#....##.",
"...#...##...###....##.....###.#",
".....#.....#.#.#.........#..###",
"#.#......#.#..#.####..#........",
"#....#.##.......##.............",
"..##...........#....#.....##..#",
"..#...#...........#....#...#...",
"...#...#...#.....#..#....#....#",
"#......##.........#.#...##...#.",
".##..#...#.....#....#.##.####.#",
"#..##.##.#......#.............#",
".#.....#..##.###.#.#.#.........",
".###....###..#....#..#.#.#..##.",
"....#........#..#....##..#.#.#.",
".....#..........#..........#...",
".#.##..#..#...#..#.##.#.##.....",
".#....#...#......#.#..##.##..#.",
".###.#...#.#.##....#.....#..##.",
"......##.......#..#.......#.#.#",
".##.#.#.#......#.......#.......",
"#..#...##......#.......#......#",
"...#..#...##.#...#..##.........",
".....#..###...##...#..#.#...#.#",
"..#.#.#....##..#.#.#.#...#.....",
".....#.#.#..#..#.#.#...#.......",
"#.#.#...#.#.....#.#.#.##.###...",
".....#.#.....####..#...........",
"..#.#.#...........##..#.#....#.",
".#..#......#..#...........###..",
"..#...###.##......#..###...#..#",
"#.#..#.....#..#.##.#..#.#.....#",
".....................#.#..#....",
"...##..##...#.#..#..##.#....#..",
".#..#.#....#...#.#.##..........",
"....##.....#..#..##.........##.",
"..##...##........#.#....#...###",
".#...#............#.#.#.#......",
"#...#........#..#..#...#.#.....",
"..#..........#.......###.##....",
"#...........###..#....##..#.##.",
"##...#..#.##.....#...........#.",
".#..##.....#..#.#.....##.#..#.#",
"..#..#.##....#.........#.#.#...",
"#..#...#...#..#...........##...",
".....#.......#.#......#.#.#...#",
"..#.#..#..#.#.#.......#.#...#..",
"......#.....##.....#.....##.##.",
"#.#..#......#......#.####.##...",
".####...#####.#....#.#..##.....",
"............#....#....#....##..",
"###.........#............#.#...",
"...#...#....#.##..#...#......##",
"...##.#.#.##.##.#.....#...#.#..",
"...#.....#...#..##......#.#.##.",
".##.#......##................##",
"......#.....#..##.............#",
"#.#...##..#..#..#.##.....#..#..",
"#......###.....#....##...##...#",
"....#..#.....#.......####...##.",
"#.#...#.#...#..........#..##..#",
"....#..#....#................##",
".####..#........#..#.#...#.....",
"##.###...#.##........#..##.....",
"..###..##...#...#..#...##.....#",
"......#..##....................",
".#...#......#.#.##..#........#.",
"..#...#####.....##.....#...#...",
".#..#....#..#....##.#....#..##.",
".#.....##..###.#.....#.#.#.##..",
"#..##.....##...#.....#..#.#....",
"#.##......#.#......#..........#",
"#####........#.............#...",
".#..#..##..#....#.....#..####..",
"...#..##.##...####....#.##...##",
"..........#....#...........##.#",
"#...##...#...##....#.....#.....",
".......#..#.....#.#.#.#.#.....#",
"...#..##..####..#..##.#.##....#",
"#...#...#...........#.#.....#.#",
"..#.....##...###.........#..##.",
".......##..#.......#.......##..",
"#.#....#....#.###............#.",
"...#......#.#.............#.#..",
"......#..#....#....#....#..#...",
".....##..#...........##...#.##.",
"..#....#.##.#......#...........",
"#...#....#.#.#.#.#..#..........",
".#..#..........#..#.#.....#....",
".....##......##....#.#.....#.#.",
".....#..#..........#....#.....#",
"....#..#..#.#...#.#..#..#..##.#",
".#..##.#..##...###.#..........#",
"..###..#......#...##...#.#.....",
"..#...#...#.....#.......#....#.",
"#...##..#.##.#....##.....#.....",
"..#.#.....#...#...#............",
".......#.#.#..#.....###.#...##.",
"....##.......#####...##..##..#.",
"#...#.##.....#.#...##.........#",
"..#.##..........#..###.#....#..",
"#......#.##...#...#.....###....",
"................#.##...........",
"##.###.#.#.#.##......##..#....#",
"..#.#........##..#..##.........",
"###....#..#....#..##....#.....#",
"#......#..#...........#.#...##.",
"...###.......#...#......##..#.#",
".......#...##.#.#...#.##......#",
"......##..#...##.#.#...##....#.",
"..#...#...#...#.#.....#..##..#.",
"..##...#.....#.....#..##.......",
"....#........#.#.##.......#.#..",
"#...#..##..#..##..#...#......#.",
"...#..#.#.#..#..#..####...#....",
"#..#..#......#......#..#.######",
"#..#..#..#........#..#.#....###",
"#..##..#.#.##.....#..#......#.#",
"##.......##.#..#.............#.",
"..........#.#..#..#............",
"....#.#.#.#...#......#......#..",
"###.#.#.........#.......#...##.",
"#.............####..#...#.##...",
"....##.......#................#",
"###...#..#......##....#.####.#.",
"..##.##.#.#.#.#...#.......#...#",
".....#.##......#.......##..#.#.",
".#...#.##..#.......#.#....#.#.#",
"##...##..#....#..#...#....#....",
"..........#...##.#..##.......##",
"#.#...#....#......#.#.......###",
"......#...#.##....#....##.#.##.",
"..#..#.......#.......#....##...",
"##..##.......##............#.#.",
".#.#...#..#.#.###......#.......",
"#...#..##....#...###..#.#.....#",
".#.....#........#..##.#.#.#....",
"..#.##....#..#...........#...#.",
".....#.#...#.##..###...#...#...",
"#....####.......#..#.#...#.....",
"....#.....#....##..#.##.....###",
"........#.#.....###....#.#.....",
"...#.....#.##.....#......#.....",
".....#...####......###..#...##.",
"#.#......#..........#..##.#..#.",
"..##......###...#...#.......#..",
"#...#.#...#.#.........#........",
"....#..#.##.#.##.###..#.....#..",
".#.#.#......#.#........#.....#.",
".....#.#..#....#...#.....#.#.##",
"##.............#..#.....#.#....",
"#............#..#....##......##",
"#....#......#......#....##..#..",
".#....#............#......##..#",
"..#.#.#..#.#....##.#.......#.##",
"#.##.....#...#......#...#......",
".......#...........#..#.##..#.#",
"##.....##.#.....####..........#",
"...#.......#.#.............#..#",
"...##........##..#..#.#........",
".#.##...#.....##.#......#....#.",
".#................#.#...#..#...",
"#....#.#.#......#.#.#.##....#..",
"..#......#............#...#....",
"###..#.##........#....##.#...#.",
".#..#..#......##...............",
"....##.............#....##...##",
"..#.#..#.#####....##.......###.",
"......#...#..#.#....#.#..#...#.",
".........#..##.##...#....##..##",
".............#.##....###.#.....",
"..#................#..#.#..#...",
"...#........#......#..###......",
".#.#.#....#.........#...###.###",
".........#..#.#......##.....#..",
"#...##..#.#.###..###...........",
"...#.#.#..#......#..##.#.##....",
".....##.......#................",
".##....#.#.#.##.....#.##......#",
"...#........#...##.#.##..##...#",
"..#..........#.#......####..##.",
"............#.#.#.#.....#......",
"..##.####.#..#....#..#..##.....",
"......#........#...#..#.#..###.",
"#.#..............#..#...#..#...",
"....#............#...#..#...##.",
"..##....#...##.##.#..........##",
"..#..#.........#..#.....#.#....",
"#.....#.###...##...##...##.....",
"#.#...#..#####.#...#..#.....#..",
"..#.....###...#.........#.#...#",
"....#.##.........#.#.....#.#.#.",
"..........##...#....#.#.#.....#",
"...#...........#.....###.......",
"#....#..#...#.....#.......#....",
".#.#.....#..##..##..#........#.",
".#.#.....#....#...#.#.##.......",
"....###...#...###.##....#......",
"...#.#.##....#...##......#...#.",
"#....#...##.....#.##.#.....#.##",
".#.#.....##.##.##..###...#.....",
".#.#......#..#..#........#.#..#",
"........#...##........##...#...",
".#..#.#.#..#.....#....#...#.#..",
"#......#...#.#...#..#.#..#.....",
".#......#.....#.........###.#..",
"#..#..........##..###.......#..",
"#..#..#....#......#......#.....",
"......#.....##.........##....#.",
"#..#.#...#...#.##.#..#..##.....",
"....#.#....###..#.....#...##.#.",
"..##.....##.#..#..##..#.#......",
".........#..#....###...#.#....#",
".........#...#...#...#......##.",
".......#..#.....#.#.#...#...#..",
"............#.....###......#..#",
"#....##..###.......#...##....##",
"..#.##..#####..##.#...#......#.",
"#.#..#...###.............#.#...",
"##...#..#..#.#....#.#.......#..",
".....#....##.....###.##..#.....",
"......##..##..#.#..####.#......",
"..#...#.#....#...#.#.........#.",
"##.....#.#....#..#..##........#",
"...........#..#........##..#...",
"..##.#...#.#.#..##..#..#..#..##",
"..........#.###.....#..#.....#.",
"......#............###..##.##..",
".#.......#..#...........#.###.#",
"#...#..##............##.......#",
".###..#...#.#....#....#......#.",
"..##.........##............#.#.",
".##.......##....#.#.#....#..#.#",
"#.##........#.....#.##...#.#...",
"#......#....#.#......##....#..#",
"#.##..##..#...#.###......#.....",
"..........#.#....###.#.....##..",
"#..##...#.###..#.............#.",
".#.#......#.##.#...#....#.....#",
".##...#..##...#...........#.##.",
".##..#.#.#..#.....#.....###....",
".#...#.#.#..#..#....##...#..#..",
"#.#.#....#.....#..#..##..#.#...",
"......#..#...####..#.........#.",
".#.#..#......#...#..####.....#.",
"...#.#...#...#....##..#.#.#.##.",
"...#........##.............#.#.",
"...#...#...#.......#..#.#.#..##",
".####.#...##......#.##.##.#.#..",
"#..###...........#..#.#...#.#.#",
"###...#.#..#...#.#...#.#..#.#.#",
"#....#.....##...#.#...#..#.#...",
".#........##.##....##..#..#....",
".#.#.#..#........#...#..#.#.#.#",
"#.##.....#.#...#....##...#..#.#",
"..#.......##.#.###............#",
"##....###..##.........##..#.#..",
"...##...#...#..###.#.....##..#.",
"###.................#.#..#.....",
"....#......#.....#..###......##",
".......#...##..#...............",
".#.....#..#.....#...##...#...##",
".....##....#.#..#.##.....#...#.",
"#..####.#....#..#.....#....#..#",
"..#..##.#.##......#..#.#....#..",
"..#.#.#.#.....#...#...#..#.....",
".#........#.#...#.#..#...##....",
".#...#.#...#..#.#...###...#.#..",
"#.....#...##..#.....#...#.#..#.",
"...#....#................#.#...",
"......##.#.#..........#...#....",
".##..#.#.#...#..#...####.#.....",
"#......#....#..#.......#.......",
".#........#.#.#....###.#..##...",
"....##......#.....##...#...#...",
"..#..#.#.#...#..#.####.##......",
"...#........#.#.##.#..#.##.#...",
".#..##...#...#...##.......##.#.",
"#...#.#......#.................",
"..#..#.....#....##...#..###....",
".#...#.........#.#.##.#........",
]



let map = makeMap(input)
let columns = input[0].length
let stepSizeRight = 3
let stepSizeDown = 1
let trees = part1(map, columns, stepSizeRight, stepSizeDown)
console.log("part 1, trees=", trees)


let directions = [
    [1, 1],
    [3, 1],
    [5, 1],
    [7, 1],
    [1, 2],
]
let total = part2(map, columns, directions)
console.log("part 2, total=", total)
